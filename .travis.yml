version: "~> 1.0"

env:
  global:
    - VERSION=latest

services:
  - docker

before_install:
  - if [ -z ${TRAVIS_TAG} ] || [ ${TRAVIS_TAG} == *-* ]; then export VERSION=latest;
    else export VERSION=${TRAVIS_TAG}; fi
  - echo ${TRAVIS_TAG}
  - echo ${VERSION}

script:
  - docker build -t sorintlab/ercole-web .

deploy:
  provider: script
  script: bash docker_push.sh
  on:
    all_branches: true
    condition: $TRAVIS_BRANCH =~ ^(master|2.0)$
    # branch: master
